language: python

notifications:
  email: false

cache:
  directories:
   - $HOME/.cache/pip

env:
  matrix:
    - DISTRIB="conda" PYTHON_VERSION="3.5" COVERAGE="true"
    - DISTRIB="conda" PYTHON_VERSION="3.6" COVERAGE="false"

install: source build_tools/travis/install.sh

script:
  - if [ ${COVERAGE} == "true" ];
    then pytest --cov=skopt --durations=10; else
    pytest --durations=10;
    fi

after_success:
  - if [ ${COVERAGE} == "true" ]; then
    pip install codecov;
    codecov;
    fi

deploy:
  provider: pypi
  user: mimba
  password:
    secure: "cYAdD2Z5JLeB/4KW6rYwtMOkwQ++W0uf6Q4qtc1h3s3+JA/DapJVAouz1hbA2vPou98pYWwypnnYBbtQYnlKO51Crl7A86brqgTlSV+HjAqBSRg5Gp6e63kZ8605/aAegVforAcXqqY7hb9kr13XLe0LPk7ySTT+/TitzKIk1bZKvMi7VI9TJB8uzUDiMFUICE+Pk6lSuNUmNPyM766/INq+OdDZ9IV2R/F71QiA1s29Bvv7tFJOZrG8ME+AiyrzKzWpbfp7pl5XqFuRFINPy2+wcxgjjc5+y+s1Tm0xSMZLpqItNyNyfOmkr9hwAlXJhbAwQToVLmz+OJHHSKefAe0ma/5t0IeccW844ag1UT95/bcBCrFSWSG3izdEEJBbVwKf6sDQ2ILW5m4ok2tHsQHbpqhz44TBIV1XJbVXkjaIvV2AJhUBOxgZ5K0a1n9hdm+BunBTa4zsEWEufrCh4PnBqmLSJiarzjhMQafnpzC855Tg0r+QPEDabUwECZiIV7m/kSG1IMKh34KyK8tejmSRwRGtI4q2nI+R4fuOT945lVbwTRSp5UU8jRW4P5TkSMj9aYM9m+qol7tYSfMWBd0iuSeSCuvaD1wDM0G4o3rl9OYhFeRkzqmNT6+lHyPReZKGzkHJUYY5ffsPRY7MgN7kM87j+jcmpHRuygxK8Rw="
  # this line together with `setup.cfg` creates universal wheels as long as
  # skopt is a python only module (no compiled code)
  distributions: sdist bdist_wheel
  on:
    tags: true
    repo: mimba/scikit-optimize
    condition: "$PYTHON_VERSION = 3.6"
