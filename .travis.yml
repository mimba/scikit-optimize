language: python

notifications:
  email: false

cache:
  directories:
   - $HOME/.cache/pip

env:
  matrix:
    - DISTRIB="conda" PYTHON_VERSION="3.5" COVERAGE="true"
    - DISTRIB="conda" PYTHON_VERSION="3.6" COVERAGE="false"

install: source build_tools/travis/install.sh

script:
  - if [ ${COVERAGE} == "true" ];
    then pytest --cov=skopt --durations=10; else
    pytest --durations=10;
    fi

after_success:
  - if [ ${COVERAGE} == "true" ]; then
    pip install codecov;
    codecov;
    fi

deploy:
  provider: pypi
  user: mimba
  password:
    secure: "L0YkUtM1gHChMKhTUsZxydP4ZgQYYQ5199PHMcQFd5DOcTFvidIjPrt/jkGsqeOXvAChLyk5vlZEmMmJ9P6xqMZ6LPCLoVQCGrufiHrBscr4aswWucvo0AT3dIoYP8EBhR7eo9hFOsp3mMC4N89RmldgEPqMgMq1hgmu2fErBWFBOoc5pGYWW5V3yWxii3lNcdkdlFLRCbHGFT5e3wA+ehReMXXNAjFL4iW+5h87JM+5g3xwHPovMcMxNRMdPxhayT6/nBiriCGK3crmKpZd2jjlfQ8RryuB4keJTb4IlJTWIaUVfu1cd5R/A0DZMINJQLNKdwu2VUWc397xn4YYeHB6nUVnOhlGpO4z2dnn6JoNye++I7gx8d5dh7OBONO7KkTnF5DL+bRriwp8MLBhKbxZrvZLf6eY76nJH1Fw7NlWK+UrMilv8BG485wYKhzhhiNQScTIWTUYwPx6XDXq8z+32GP0tJEY60vMZVU7aJ//kklQOcwbJLmf3QMf0uCnfM3S3OxHvSJODIG1mRvcsyMjoCvnZbqqoi7lx4KbLpBw+bIG3fQ06nuYN3Tdro15B1M1l5nOX2b2qZRPcMeERUssjGH+XTQc2xR0qN7NNi2tpR1FnnBF1gEgSWcLt/hnYZUtNzbKL+aUDcomfpX8FA/NhvD3BmAabeU0qETjiHo="
  # this line together with `setup.cfg` creates universal wheels as long as
  # skopt is a python only module (no compiled code)
  distributions: sdist bdist_wheel
  on:
    tags: true
    repo: mimba/scikit-optimize
    condition: "$PYTHON_VERSION = 3.6"
